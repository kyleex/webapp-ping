<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Page d'Administration</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- Bibliothèque Axios pour les requêtes AJAX -->
    <script src="server.js"></script>
  </head>
  <body>
    <aside>
      <button id="goToFormBtn">Envoyer un nouveau formulaire</button>
      <script>
        // Utiliser Fetch API pour récupérer les données du serveur
        // et les afficher dans le tableau...

        // Gérer le clic sur le bouton pour rediriger vers form.html
        document
          .getElementById("goToFormBtn")
          .addEventListener("click", function () {
            window.location.href = "/form"; // Change this to the path of your form page
          });
      </script>
    </aside>

    <h1>Liste des Formulaires Soumis</h1>
    <table id="form-table">
      <tr>
        <th>Nom</th>
        <th>Email</th>
        <th>Message</th>
        <th>Action</th>
      </tr>
      <!-- Les lignes du tableau seront ajoutées ici par JavaScript -->
    </table>

    <script>
      // Utiliser Fetch API pour récupérer les données du serveur
      fetch("/get-form-data")
        .then((response) => response.json())
        .then((data) => {
          const tableBody = document
            .getElementById("form-table")
            .querySelector("tbody");
          data.forEach((item) => {
            let row = tableBody.insertRow();
            let cellName = row.insertCell(0);
            let cellEmail = row.insertCell(1);
            let cellMessage = row.insertCell(2);
            let cellAction = row.insertCell(3);
            cellName.textContent = item.name; // Assure-toi que les propriétés correspondent à celles de ton JSON
            cellEmail.textContent = item.email;
            cellMessage.textContent = item.message;

            // Tu peux ajouter des boutons ou actions dans `cellAction` si nécessaire

            // Créer un bouton Valider
            let validateButton = document.createElement("button");
            validateButton.innerText = "Valider";
            validateButton.onclick = function () {
              // Appeler une fonction pour valider l'inscription
              validateEntry(item, index);
            };

            // Créer un bouton Refuser
            let rejectButton = document.createElement("button");
            rejectButton.innerText = "Refuser";
            rejectButton.onclick = function () {
              // Appeler une fonction pour refuser l'inscription
              rejectEntry(item, index);
            };

            cellAction.appendChild(validateButton);
            cellAction.appendChild(rejectButton);
          });
        })
        .catch((error) => console.error("Error:", error));

      // Fonction pour valider l'inscription
      function validateEntry(entry, index) {
        // Ici tu enverrais une requête au serveur pour valider l'entrée
        console.log("Valider l'inscription:", entry);
      }

      // Fonction pour refuser l'inscription
      function rejectEntry(entry, index) {
        // Ici tu enverrais une requête au serveur pour refuser l'entrée
        console.log("Refuser l'inscription:", entry);
      }
    </script>
  </body>
</html>
